#! /bin/bash

set -e

echo "Creating virtualenv 'r-reticulate'"
virtualenv --system-site-packages --python=/usr/bin/python3 $WORKON_HOME/r-reticulate

source $WORKON_HOME/r-reticulate/bin/activate
alias make="make --jobs=`nproc`"

pip list

echo "Installing 'reticulate', 'rTorch' and 'keras'"
Rscript -e "install.packages(c('reticulate', 'rTorch', 'keras'), quiet = TRUE)"
Rscript -e "reticulate::py_discover_config()"
Rscript -e "keras::is_keras_available()"

